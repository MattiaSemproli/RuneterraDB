<!DOCTYPE HTML>
<!--
	Solid State by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>

	<head>
		<title>RuneterraDB | Wiki</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="../assets/css/main.css" />
		<link rel="stylesheet" href="../assets/css/centerBox.css" />
		<noscript>
			<link rel="stylesheet" href="../assets/css/noscript.css" />
		</noscript>
	</head>

	<body style="display:flex">

		<!-- Header -->
		<header id="header" class="alt">
			<h1><a href="index.html">RuneterraDB</a></h1>
			<nav>
				<a href="#menu">Menu</a>
			</nav>
		</header>

		<!-- Menu -->
		<nav id="menu">
			<div class="inner">
				<h2>Menu</h2>
				<ul class="links">
					<li><a href="index.html">Home</a></li>
					<li><a href="gtc.html">Guess the champion</a></li>
					<li><a href="login.html">Log In</a></li>
					<li><a href="registration.html">Sign Up</a></li>
				</ul>
				<a href="#" class="close">Close</a>
			</div>
		</nav>

		<!-- Center left -->
		<div id="leftBox">
			<div id="championsBox">
			</div>
			<script>
				const champsList = document.getElementById('championsBox');
				window.addEventListener('load', function() {
					var xhr = new XMLHttpRequest();
					xhr.open('GET', '../php/getChampionWiki.php', true);
					xhr.onload = function() {
						if (xhr.status === 200) {
							var data = JSON.parse(xhr.responseText);
							load(data);
						} else {
							console.log('Errore nella richiesta: ' + xhr.status);
						}
					};
					xhr.send();
				});

				function load(data) {
					for (var i = 0; i < data.length; i++) {
						(function(){
							var singleData = data[i];
							var box = document.createElement("div");
							var name = document.createElement("div");
							var item = new Image();
							var imageUrl = "../sources/ChampionsIcon/"+ singleData[0].replaceAll(' ','') +"_0.jpg";

							name.textContent = singleData[0];
							name.classList.add("championsName");

							item.classList.add("Icon");
							item.src = imageUrl;
							
							item.onclick = function() {
								icon();
								name();
								data();
								getChampionStats();
								getChampionLore();

								function icon() {
									var iconBox = document.getElementById("championsIcon");
									var champIcon = new Image();
									iconBox.classList.add("subBox");
									champIcon.classList.add("cIcon");
									champIcon.src = imageUrl;
									removeAllChildNodes(iconBox);
									iconBox.appendChild(champIcon);
								}
								
								function name() {
									var nameBox = document.getElementById("championsName");
									nameBox.classList.add("subBox");
									removeAllChildNodes(nameBox);
									for (var i = 0; i < 2; i++) {
										var champName = document.createElement("div");
										champName.textContent = singleData[i];
										nameBox.appendChild(champName);
									}
								}

								function data() {
									var dataBox = document.getElementById("championsData");
									dataBox.classList.add("subBox");
									removeAllChildNodes(dataBox);
									for (var i = 2; i < singleData.length; i++) {
										var champData = document.createElement("div");
										champData.textContent = singleData[i];
										dataBox.appendChild(champData);
									}
								}

								function attributes(stats) {
									var attributesBox = document.getElementById("championsAttributes");
									attributesBox.classList.add("subBox");
									removeAllChildNodes(attributesBox);
									Object.keys(stats).forEach(key => {
										var champAttribute = document.createElement("div");
										champAttribute.textContent = key + ": " + stats[key];
										attributesBox.appendChild(champAttribute);
									});
								}

								function nickname(nick) {
									var nicknameBox = document.getElementById("championsNickname");
									nicknameBox.classList.add("subBox");
									var champNickname = document.createElement("div");
									champNickname.textContent = nick;
									removeAllChildNodes(nicknameBox);
									nicknameBox.appendChild(champNickname);
								}

								function lore(bio) {
									var loreBox = document.getElementById("championsLore");
									loreBox.classList.add("subBox");
									var champLore = document.createElement("div");
									champLore.textContent = bio;
									removeAllChildNodes(loreBox);
									loreBox.appendChild(champLore);
								}

								function getChampionStats() {
									var xhr = new XMLHttpRequest();
									xhr.open("GET", "../php/getChampionStats.php?champion=" + encodeURIComponent(singleData[0]), true);
									xhr.onload = function() {
										if (xhr.status === 200) {
											var stats = JSON.parse(xhr.responseText);	
											attributes(stats);
										} else {
											console.log('Errore nella richiesta: ' + xhr.status);
										}
									};
									xhr.send();
								}

								function getChampionLore() {
									var xhr = new XMLHttpRequest();
									xhr.open("GET", "../php/getChampionLore.php?champion=" + encodeURIComponent(singleData[0]), true);
									xhr.onload = function() {
										if (xhr.status === 200) {
											var lor = JSON.parse(xhr.responseText);	
											nickname(lor['nickname']);
											lore(lor['bio']);										
										} else {
											console.log('Errore nella richiesta: ' + xhr.status);
										}
									};
									xhr.send();
								}

								function removeAllChildNodes(parent) {
									while (parent.hasChildNodes()) {
										parent.removeChild(parent.childNodes[0]);
									}
								}
							}
						
							item.onmouseover = function() {
								this.style.opacity = ".4";
								name.style.opacity = "1";
							};
							item.onmouseout = function() {
								this.style.opacity = "1";
								name.style.opacity = "0";
							};

							box.appendChild(name);
							box.appendChild(item);

							champsList.appendChild(box);
						})();
					}
				}
			</script>
		</div>

		<!-- Center right -->
		<div id="rightBox">
			<div id="championsInfo">
				<div id="championsProfile">
					<div id="championsIcon"></div>
					<div id="championsName"></div>
				</div>
				<div id="championsBio">
					<div id="championsData"></div>
					<div id="championsAttributes"></div>
				</div>
			</div>
			<div id="championsStats">
				<div id="championsNickname"></div>
				<div id="championsLore"></div>
			</div>
		</div>
		
		

		<!-- Footer -->
		<footer id="footer">
			<div class="inner">
				<ul class="copyright">
					<li>&copy; All rights reserved to Mattia Semproli & Martino Pagliarani</li>
				</ul>
			</div>
			</section>

			<!-- Scripts -->
			<script src="../assets/js/jquery.min.js"></script>
			<script src="../assets/js/jquery.scrollex.min.js"></script>
			<script src="../assets/js/browser.min.js"></script>
			<script src="../assets/js/breakpoints.min.js"></script>
			<script src="../assets/js/util.js"></script>
			<script src="../assets/js/main.js"></script>

	</body>

</html>